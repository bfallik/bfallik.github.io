# static website

Configuration and scripts to manage my personal static website,
[bfallik.net](https://bfallik.net).

## Getting Started

These instructions will get you a copy of the project up and running on
your local machine for development and testing purposes. See deployment
for notes on how to deploy the project on a live system.

### Prerequisites

You'll need [Hugo](https://gohugo.io) and git.

```
$ dnf install hugo git
```

Don't forget to update the submodules:

```
$ git submodule init
$ git submodule update --recursive --remote
```

## Testing

You can use `hugo server` to preview your changes on a local server
before deploying them publicly.

```
$ hugo server

                   | EN
+------------------+----+
  Pages            |  6
  Paginator pages  |  0
  Non-page files   |  0
  Static files     | 39
  Processed images |  0
  Aliases          |  0
  Sitemaps         |  1
  Cleaned          |  0

Total in 29 ms
Watching for changes in /home/bfallik/sandbox/bfallik.net/public-www/www.bfallik.net/{content,themes}
Watching for config changes in /home/bfallik/sandbox/bfallik.net/public-www/www.bfallik.net/config.toml, /home/bfallik/sandbox/bfallik.net/public-www/www.bfallik.net/themes/vncnt-hugo/config.toml
Environment: "development"
Serving pages from memory
Running in Fast Render Mode. For full rebuilds on change: hugo server --disableFastRender
Web Server is available at http://localhost:1313/ (bind address 127.0.0.1)
Press Ctrl+C to stop
```

## Deployment

The website is hosted on [Github Pages](https://pages.github.com/) in the repo https://github.com/bfallik/bfallik.github.io.

To generate new static HTML simply invoke `hugo`:

```
$ hugo

                   | EN
+------------------+----+
  Pages            |  6
  Paginator pages  |  0
  Non-page files   |  0
  Static files     | 39
  Processed images |  0
  Aliases          |  0
  Sitemaps         |  1
  Cleaned          |  0

Total in 31 ms
```

Use `deploy.sh` to commit and deploy the new HTML:

```
$ % ./deploy.sh
+++ dirname ./deploy.sh
++ cd .
++ pwd
+ DIR=/Users/bfallik/sandbox/bfallik.net/public-www/www.bfallik.net
+ cd /Users/bfallik/sandbox/bfallik.net/public-www/www.bfallik.net/bfallik.github.io
+ git add -A
+ git commit -m 'generated by Hugo'
[detached HEAD 548fc37] generated by Hugo
 41 files changed, 6464 deletions(-)
...
+ git push origin HEAD:master
Enumerating objects: 5, done.
Counting objects: 100% (5/5), done.
Delta compression using up to 8 threads
Compressing objects: 100% (3/3), done.
Writing objects: 100% (3/3), 296 bytes | 296.00 KiB/s, done.
Total 3 (delta 2), reused 0 (delta 0), pack-reused 0
remote: Resolving deltas: 100% (2/2), completed with 2 local objects.
To github.com:bfallik/bfallik.github.io.git
   6627643..548fc37  HEAD -> master
```

and then verify the changes appear on https://bfallik.net.

DNS for bfallik.net is served by [domains.google.com](https://domains.google.com). Specifically
1. a Synthetic Record for subdomain forwarding, temporarily redirecting (301) bfallik.net to www.bfallik.net
2. a www CNAME record pointing at bfallik.github.io
